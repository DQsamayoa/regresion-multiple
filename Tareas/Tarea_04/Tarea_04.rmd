---
title: "Métodos de diseño y Análisis de Experimentos"
subtitle: "Tarea 02"
author:
  - "Rivera Torres Francisco de Jesús"
  - "Rodríguez Maya Jorge Daniel"
  - "Samayoa Donado Víctor Augusto"
  - "Trujillo Bariios Georgina"
date: "Marzo 06, 2019"
output:
  pdf_document:
    toc: false
    number_sections: true
    fig_caption: true
    highlight: kate
    df_print: kable
    includes:
      in_header: tex/header.tex
fontsize: 11pt
documentclass: article
classoption: twoside
fig_align: "center"
---

```{r setup, include = FALSE, eval = TRUE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, fig.height = 3)

# Se cargan las librerias a utilizar
library(tidyverse)
library(readxl)
library(scales)
library(grid)
library(kableExtra)
library(latex2exp)
```

# 1. ----------------------------------------------------------------------



# 2. \begin{enumerate}

\item Mostrar que, para el modelo RLS, se cumple

\begin{equation}
    \begin{split}
    \notag F = \frac{R^2\left(n-2\right)}{1-R^2},
    \end{split}
\end{equation}

donde F es el estadístico del ANOVA y $R^2$ es el coeficiente de determinación del modelo.\\

Sabemos que 

\begin{equation}
    \begin{split}
    \notag R^2 =1- \frac{SCE}{SCT}, \quad F = \frac{SCR}{\frac{SCE}{(n-2)}} \quad \text{y} \quad SCT = SCR + SCE
    \end{split}
\end{equation}

Entonces

\begin{equation}
    \begin{split}
    \notag F &= \frac{SRE}{\frac{SCE}{(n-2)}} =\frac{SCR(n-2)}{SCE} = \frac{(SCT-SCE)(n-2)}{SCE} \left( \frac{SCT}{SCT} \right)\\
	&= \frac{\left( \frac{SCT}{SCT}-\frac{SCE}{SCT} \right) \left( n-2 \right)}{\frac{SCE}{SCT}} = \frac{\left( \frac{SCT}{SCT}-\frac{SCE}{SCT} \right) \left( n-2 \right)}{1-1+\frac{SCE}{SCT}} = \frac{\left( 1-\frac{SCE}{SCT} \right) \left( n-2 \right)}{1-\left( 1-\frac{SCE}{SCT} \right)}\\
	&= \frac{R^2\left(n-2\right)}{1-R^2}
    \end{split}
\end{equation}

Por lo tanto

\begin{equation}
    \begin{split}
    \notag F = \frac{R^2\left(n-2\right)}{1-R^2},
    \end{split}
\end{equation}

\item Suponer que para un conjunto de 20 pares de observaciones $(x, y), r=-0.74$. Si se ajusta un modelo RLS a estos datos, ¿que se puede decir sobre la significancia del modelo?\\

Pdemos decir que el modelo tiene una asociación lineal inversa fuerte entre las observaciones $(x, y)$, es decir, si una crece la otra decrece.

\end{enumerate}



# 3. Los siguientes datos representan la relación entre el número de errores de alineación y el número de remaches faltantes para 10 diferentes aeronaves

Los siguientes datos representan la relación entre el número de alineación y el número de remaches faltantes para $10$ diferentes aeronaves.

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|}
\hline
Num. remaches (x) & 13 & 15 & 10 & 22 & 30 & 7 & 25 & 15 & 20 & 15 \\ \hline
Num. errores (x) & 7 & 7 & 5 & 12 & 15 & 2 & 13 & 9 & 11 & 8 \\ \hline
\end{tabular}
\end{center}
\end{table}

\begin{enumerate}

\item Ajustar un modelo RLS e interpretar las estimaciones de los coeficientes del modelo.

```{r, echo = TRUE}
num_remaches <- c(13, 15, 10, 22, 30, 7, 25, 16, 20, 15)
num_errores <- c(7, 7, 5, 12, 15, 2, 13, 9, 11, 8)
aeronaves <- data.frame(num_remaches, num_errores)
modelo <- lm(num_errores~num_remaches, data = aeronaves)
summary(modelo)$coefficients
```

Para el coeficiente $\beta_0$ se tiene un número negativo, lo que nos indica que tendriamos $-0.6639$ errores cuando no tenemos remaches y para el coeficiente $\beta_1$ podemos interpretar que tenemos aproximadamente la mitad de errores según la cantidad de remaches

\item Graficar el diagrama de dispersión de los datos y sobreponer la recta de regresión ajustada.

```{r, echo = TRUE}
plot(num_errores~num_remaches, data = aeronaves, xlab = "Número de Remaches",
     ylab = "Número de Errores")
abline(modelo, col = "blue", lwd = 2)
```

\item Reportar el $R^2$ del modelo ajustado. ¿La interpretación del $R^2$ es consistente con la gráfica del inciso anterior?

```{r, echo = TRUE}
summary(modelo)$r.squared
```

Obtenemos una $R^2$ de $0.9683$ lo que nos indica que sí es consistente puesto que el modelo se ajusta bien en la grafica de dispersión.

\item Contrastar las hipótesis

\begin{equation}
    \begin{split}
    \notag H_0 : \beta_0 = 1 \quad \text{v.s.} \quad H_1 : \beta_0 \not = 1
    \end{split}
\end{equation}

Utilizar el tamaño de prueba $\alpha = 0.1$. Interpretar el resultado en el contexto del problema.

```{r, echo = TRUE}
#calculamos el estadistico de prueba
b_0 <- 1
v.b_0.est <- vcov(modelo)[1,1]
b_0.est<-summary(modelo)$coefficients[1,1]
T <- (b_0.est - b_0)/v.b_0.est

#cuantil de t (n-2)
t <- qt(1-.1/2, df.residual(modelo))
T
t
```

Como $3.88 = |T|>t = 1.85$ rechazamos $H_o$, es decir que en el modelo $\beta_0$ debe ser diferente de 1 en el contexto del problema nos indica que no podemos obtener errores si no hay remaches.

\item Estimar puntualmente el número esperado de errores de alineación de un avión con 24 remaches faltantes y construir un IC 90\%.\\

Estimamos puntualmente:

```{r, echo = TRUE}
b_1.est <- summary(modelo)$coefficients[2,1]
y.24 <- b_0.est+(b_1.est*24)
y.24
```

La estimación es de 12.6 errores.

Intervalos de confianza:

```{r, echo = TRUE}
s2.est <- summary(modelo)$sigma^2
ta <- qt(0.95, n-2)
IC.24 <- y.24+c(-1, 1)*ta*sqrt(s2.est)
IC.24
```


# 4. Utilizar el conjunto de datos que se envía adjunto para responder lo siguiente.
```{r}
cancer <- read.table("tarea_cancer.csv", header = TRUE, sep = ",")
```

## a) Graficar un diagrama de dispersión del número de cigarros por persona (variable cigarrette) contra la tasa de muertes por cáncer de pulmón (por cada 100, 000 habitantes, variable lung). ¿La gráfica indica la posibilidad de una asociación lineal entre las variables?

```{r}
    plot(cancer$cigarrette, cancer$lung, main="Diagrama de dispersión",
         xlab="número de cigarros por persona", ylab="tasa de muerte por cáncer de pulmón", pch=19)
```

La gráfica muestra que hay una asociación positiva entre el número de cigarros por persona y la tasa de muerte por cada mil habitantes causada por cáncer de pulmón.


## b) Ajustar un modelo RLS para explicar la distribución de lung como función de cigarrettes. Reportar las estimaciones de los coeficientes e interpretarlos en el contexto de los datos.

```{r}
rls <- lm(lung ~ cigarrettes, cancer)
beta0 <- coef(rls)["(Intercept)"]
beta1 <- coef(rls)["cigarrettes"]
```

El valor del intercepto $\beta_{0} =$ `r beta0` podría interpretarse como la tasa de muertes por cáncer de pulmón (por cada $100000$ habitantes) dado que en el estado observado el promedio o número de cigarros por persona es cero. Esto puede tener sentido debido a que fumar tabaco puede no ser la única causa de cáncer de pulmón. 
El valor de $\beta_{1}=$ `r beta1` por su parte indica que un incremento de un cigarro más a nivel estatal incrementaría la tasa de muerte por cáncer de pulmón en $0.0052$. 

## c) Construir la tabla ANOVA para la hipótesis de significancia del efecto del número de cigarros por persona en la tasa de muertes por cáncer de pulmón.
`bquote(H[0] : b[0] == 1 vs. H[1]: != 1)`

```{r}
cancer$desvMedia <- (cancer$lung - mean(cancer$lung))^2
cancer$lungEstim <- beta0 + beta1*cancer$lung
cancer$desvEstim <- (cancer$lungEstim-mean(cancer$lung))^2
cancer$errorEsti <- (cancer$lung-cancer$lungEstim)^2 
SCT=sum(cancer$desvMedia)
SCR=sum(cancer$desvEstim)
SCE=sum(cancer$errorEsti)
```

La suma de cuadrados total es `r SCT`
La suma de cuadrados de regresión es `r SCR`
La suma de cuadrados del error es `r SCE`

```{r}

anova <- data.frame("Fuentes Variación" = c('regresión', 'error', 'total'),
                    "Grados de Libertad" = c(1, nrow(cancer)-2, nrow(cancer)-1), 
                    "Suma de Cuadrados" = c(round(SCR,2), round(SCE,2), round(SCT, 0)),
                    "Cuadrados Medios" = c(round(SCR/1,2), round(SCE/nrow(cancer)-2, 2), NA),
                    "Prueba F" = c(SCR/(SCE/nrow(cancer)-2), NA, NA))

knitr::kable(anova, caption = "ANOVA")
```



## d) Concluir sobre la significancia del modelo si se utiliza un tamaño de prueba de 0.05. Reportar el p-value de la prueba.

Rechazamos la prueba $H_{0}:\beta_{1}=0$ si el valor de $F >F_{(1,n-2)}^{(1-\alpha)}$

```{r}
estadisticoF <- df(1-0.05, 1, nrow(cancer)-2)
```

`r 'F =' SCR/(SCE/nrow(cancer)-2` $>$ `r estadisticoF`,por lo tanto con un tamaño de prueba $\alpha=0.05$ rechazamos la hipótesis nula. En otras palabras, los datos aportan evidencia estadísticamente significativa sobre la relación entre tasa de muerte por cáncer de pulmón y número de cigarros por persona.

# 5. ----------------------------------------------------------------------



# 6. ----------------------------------------------------------------------

